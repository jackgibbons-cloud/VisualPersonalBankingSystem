From the ZX80 to the PC Windows 10 version of the PBS = a 42 Year Journey.

ZX80 in 1980!

The first main challenge with writing a Banking program was in persuading the ZX80 computer to handle Pounds and Pence, plus the extra complication of displaying it properly formatted in columns!  This alone took about six weeks to achieve.

The second problem was how to accomplish this with just 1K of Random Access Memory. Fortunately, Sir Clive had an ace up his sleeve in the form of a 16k Ram Pack add-on that would wobble on the back of your ZX80.  This forced everybody to learn the practice of taking backups.

But anyway the first Personal Banking System was born!  This was advertised for sale by Syntax Software in Your Computer magazine in July/August 1981 and as far as I know sold zero copies.

ZX81 in 1981

No problem, because now we had the Sinclair ZX81 computer to write for.  So the ZX81 PBS version 2 was released (what happened to version 1?). It was demonstrated at the very first ZX Microfair in Central Hall Westminster, where I shared half a table with Stephen Adams and sold all my ten copies.  Sinclair had the 6 tables opposite and lent me their new ZX Printer to demonstrate (I promptly listed my program for the very first time).  Keen 'ZXers' were queueing around the block to get in!

This version sold several thousand copies thanks to Software Masters (part of the Computer Bookshop Group). I was sitting at my desk in my Banking job in the City (probably writing the minutes of the International Banking System meeting I had just attended). Someone phoned me to say "I wish to buy 750 copies of your program please"!

Micromega sold a further few thousand copies.  Informatique Service, Angers translated the PBS into French and sold some more copies.

We were rewarded by a great review of the PBS in the Popular Computing Weekly magazine.

ZX Spectrum in 1982

The ZX Spectrum computer with 48k Ram swiftly followed in 1982.  The Spectrum PBS was the most successful, selling around 14,000 copies through Micromega. The PBS was in the shops and we were selling overseas too!  We even had an invitation to Sinclair HQ in Cambridge to discuss a software distribution.

Later versions had 51 column displays and machine coded routines. We even had a Spanish version thanks to a customer in Menorca.  Both the ZX81 and ZX Spectrum versions appeared in the top ten programs sold by the Buffer Micro Shop in London.

BBC B, Dragon 32 in 1982

Further versions of the PBS were developed by some fellow members of the Orpington Computer Club (which I co-founded with my friend Roger Pyatt and held the first meeting in my dining room). Norman Lambert kindly produced the BBC B version, whereas Peter Denny kindly provided the Dragon 32 version and head up the Dragon Division of our company.

Grundy NewBrain

Micromega converted the PBS to run on the Grundy NewBrain and promptly sold a thousand copies. If anyone has a copy please let me know.


Amstrad CPC464 and Sinclair QL in 1983

With the release of the Amstrad CPC464 and Sinclair QL computers sporting 80 column screen displays, prompted a fresh design of the PBS to take advantage of this.  The PBS II was born!  

Account name and Bank details are shown in a 'window' at the top of the screen, with the menus squeezed in the bottom 'window' and all the activity in the middle 'window'. My own version of Windows probably.

The Amstrad CPC464 came with disk drives and was actually the computer on which I developed PBS II.  This version became the launch pad for the PC Dos version as the Basic language was very similar.

The QL version sported Procedures for the first time, although the BBC version may have had them but I did not write that.

The first QL version (2.04) was written in SuperBasic.  Version 3.5 was also written in SuperBasic but compiled using QLiberator.

One of my customers gave me another version (5) he had optimised and then compiled using the Turbo compiler.  He also gave me his Easel export module.

Sam Coupe in 1989

My Sam Coupe came with disk drives and I took the opportunity to port the PC Dos version (QuickBasic) of the PBS to the Sam Coupe (Sam Basic and Sam MasterBasic) as a challenge. The bigger challenge was to make it Procedural only.  This version also used code from the new Personal Filing System I first developed for the PC, which enabled re-definable screen displays. 

Similarly, I ported the PC PFS to the Sam Coupe PFS in the same way.

The new Budget module was developed on the Sam Coupe and ported to the PC.

Amstrad PC 1512 and compatibles (MSDos) 16 bit in 1987

I was booked in for the Personal Computer World show for September 1987 so was busy with my new PC Dos version of the PBS II.  I had been working on a Wholesale Banking System in MS Basic for a Florida based company in my daytime job on an IBM PC XT.  So I quickly settled on MS QuickBasic for development of the PBS which gave you a compiled executable.  I didn't sell all the copies.  However, I was able to develop the General Ledger module which I could use for Hilton's final accounts.

Dan PC (Windows 3.11) 16/32 bit in 1993?

Welcome to the Windows world!

Now I was working in my daytime job as a Visual Basic developer, having studied a cover disc with a demonstration version of Visual Basic 3 (VB).  I passed the interview test (miraculously) for a well known car breakdown service whose initials can be found at the beginning of the alphabet.  

So I quickly got up to speed developing the all new Visual Personal Banking System (VPBS) which is the best yet. It incorporates all the modules: Bank Reconciliation, Budget and Final Accounts (providing simple Profit & Loss + Balance Sheet).  Coupled with MS Access it provided Multiple, Multi Currency accounts.  Reporting was provided by Crystal Reports.

Dan PC (Windows 98) 16/32 bit in 1999

Although I started with Visual Basic 3 16 bit, I was progressing through the versions including VB4 16 bit and VB4 32 bit.  

The Data Access methods were changing too.

Dell PC Laptop (Windows XP) 16/32 bit in 2002?

The development moved forward, now moving onto Visual Basic 6 and replacing third party controls with the Microsoft VB6 equivalents.
The Final accounts module was developed at this time, mainly to handle my own accounts.

Dell PC (Windows 7) 32/64 bit in 2013

Windows 7 provided XP Mode so I could run the VB4 16/32 bit and VB6 versions of the Visual PBS (VPBS).

I was able to migrate the VB6 16/32 bit version of the VPBS to Windows 7 using Visual Basic 2013.  

This required a complete re-write of the VPBS because of the new VB.net data access methods. 
So, starting out in March 2015, we had brand new forms and new VB code. This took quite a lot of time, about two years.
Most of the existing SQL code was still valid. This was extended to handle all database updates: the Dataview grids became display only.
After a long parallel run the new version was very stable and became my Live version.

With this version I was able to add Automatic Bank Reconciliation. A great time saver!

Dell Precision PC (Windows 10) 32/64 bit in 2020

With a new upgrade to Visual Basic 2019, I was able to port the VB13 VPBS with just one minor code change in the newish Reconciliation module changes.  
No rewrite this time! This is my current Live version and is very stable.

Hot tip. Do not load the source code before registering Cryst32.ocx otherwise the Report Control will disappear from the forms!

What next?
The latest setup consists of VB2019, MS Access2, Crystal Reports 5 which still work well together. 
 
Upgrade Database?

I am currently investigating updates or replacements to Access2 and Crystal Reports 5. As I have Libre Office I tried loading an Access2 MDB file: it failed!  

I have looked at SQLServer but that seems a bit over the top and complicated for a single user system.

Maybe the latest version of Access will be the best option?  Cost around Â£80.

Upgrade Reporting?

I have starting looking at the VB2019 add-ons for reporting but the reviews are not very complimentary.

New versions of Crystal Reports are very expensive!

Packaging?

Packaging the VPBS using VB6 (and before) was quite straight forward but later versions of VB seem very complicated and unwieldy for a relatively simple single user application.

I have tried InstallShield using a trial offer: this was also over complicated for what I wanted to do.  
It also insisted in installing my files in some secret location and not where I asked for them to be installed.
I have used InstallShield previously while I was at the AA and that seemed to work well.

I have used VB2019 Deploy but will have to add provision for Access and Crystal runtime files, particularly Cryst32.ocx, which always seems to be a problem as it has to be registered.  This can be achieved by using RegSvr32.exe (note - there are two versions, see Microsoft Help). I could use a modified version of the VB6 VPBS Setup installer?

If anyone can add recommendations I shall be very happy to receive them....

In summary:

Although fully functional, I see the VPBS version 19 as work in progress.  It still requires some tidying up e.g. minimise the number of Datasets, remove redundant code. I have yet to code the Archive Transactions option.

I have already uploaded all the previous versions of the PBS for other computers to the respective websites e.g. Spectrum Computing/WOS, World of SAM, Dragon Archive, 8-Bit Software (BBC), Internet Archive (Amstrad CPC), dilwyn.me.uk (QL).  

Most of these versions are also available from GitHub, including the Visual PBS: more to follow.

Hot tip. Remember - Do not load the source code before registering Cryst32.ocx otherwise the Report Control will disappear from the forms!

Jack Gibbons 07/09/2020, revised 04/02/2022
